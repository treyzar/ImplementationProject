У меня уже есть существующий проект:
- Backend: Django 4.x + Django REST Framework на Python 3.10.
- Frontend: React 18 + TypeScript, Tailwind CSS, React Router.
- В проект уже интегрирован модуль "Конструктор документов" (Document Builder): есть страница на фронтенде и базовый backend (приложение documents или аналогичное).

Твоя задача:
НЕ создавать всё с нуля, а АККУРАТНО ДОРАБОТАТЬ существующую реализацию конструктора документов:
- Освежить UI/UX (современный «fresh» дизайн).
- Перевести страницу на shadcn/ui компоненты (только из разрешённого списка, см. ниже).
- Оформить всё в оранжевой палитре, похожей на фирменный стиль компании Бреслер.
- Добавить инструменты выравнивания блоков «как в Figma» (по краям, по центру, равные отступы и т.п.).
- НЕ добавлять никаких лишних backend-файлов и новых Django-приложений. Только точечные доработки там, где они реально нужны для работы текущего конструктора.

ОЧЕНЬ ВАЖНЫЕ ПРАВИЛА:
1. НЕ создавай новых Django-приложений.
2. НЕ создавай лишних python-файлов на backend: работай ТОЛЬКО с теми файлами, которые уже существуют и реально нужны (например, существующие models.py, serializers.py, views.py, urls.py в приложении documents).
3. Если можно решить задачу ТОЛЬКО на фронтенде, backend не трогай.
4. НИКАКИХ заглушек: не использовать `pass`, `...`, `# TODO`, «здесь будет логика» и т.п.
5. Всё, что ты предлагаешь, должно быть готовым к вставке в живой проект без псевдокода и плейсхолдеров.

==================================================
0. КРАТКИЙ ОБЗОР ТЕКУЩЕЙ СИСТЕМЫ (принять как данность)
==================================================

Предположи, что сейчас уже есть:

- Django-backend с REST API для:
  - шаблонов документов (Document Templates),
  - загрузки файлов (DOCX/PDF),
  - хранения JSON-схемы документа.

- Фронтенд-страница конструктора документов, которая:
  - работает с этими API;
  - имеет холст (canvas) для размещения блоков;
  - позволяет добавлять хотя бы текстовые блоки и сохранять шаблон.

Тебе НЕ нужно заново описывать модели / API с нуля. Вместо этого:
- при необходимости можешь предложить небольшие изменения в схемах данных (например, в JSON-структуре шаблона) и показать, как аккуратно доработать serializers/views;
- основное внимание — на доработку фронтенда, UI/UX и интеграцию shadcn/ui.

==================================================
1. ДИЗАЙН: ОРАНЖЕВАЯ ПАЛИТРА В СТИЛЕ БРЕСЛЕР
==================================================

Сделай интерфейс конструктора документов в «свежем» современном дизайне, с акцентом на оранжевые оттенки, похожие на фирменный стиль компании Бреслер.

Используй следующую палитру (можешь оформить это как tailwind-tokens/конфиг):

- Основной акцент (primary):   #E73F0C
- Тёмный акцент:               #C2360A
- Светлый акцент:              #FFE1D4
- Тёмный текст:                #26292A
- Вторичный текст:             #4A4D50
- Светлый фон:                 #F7F8F8
- Карты/поверхности:           #FFFFFF с мягкими тенями

Требования к стилю:
- Чёткая иерархия: крупный заголовок страницы, выраженный toolbar, чёткие панели слева/справа.
- Мягкие тени, скругления 10–12px для карточек и панелей.
- Акцентный оранжевый использовать для:
  - primary-кнопок,
  - иконок выделения,
  - состояния выбора/фокуса,
  - ползунков/ползунков zoom.
- Не превращай фон в сплошной оранжевый. Основной фон — светлый, оранжевый только как акцент.

Если потребуется, предложи патч/фрагмент для tailwind.config.js с добавлением цветовой схемы, но без абстрактных плейсхолдеров — реальные ключи/значения.

==================================================
2. SHADCN/UI: КОМПОНЕНТЫ И ИНТЕГРАЦИЯ
==================================================

В проект уже интегрирован shadcn/ui. НЕ нужно описывать установку с нуля, но в конце добавь краткий гайд, как убедиться, что всё заведётся.

Используй ТОЛЬКО эти компоненты shadcn/ui (считай, что они уже установлены через `npx shadcn-ui add` или аналогичный процесс):

- Button (`@/components/ui/button`)
- Card (`@/components/ui/card`)
- ScrollArea (`@/components/ui/scroll-area`)
- Tabs (`@/components/ui/tabs`)
- Dialog (`@/components/ui/dialog`)
- DropdownMenu (`@/components/ui/dropdown-menu`)
- Popover (`@/components/ui/popover`)
- Tooltip (`@/components/ui/tooltip`)
- Input (`@/components/ui/input`)
- Textarea (`@/components/ui/textarea`)
- Label (`@/components/ui/label`)
- Select (`@/components/ui/select`)
- Slider (`@/components/ui/slider`)
- Separator (`@/components/ui/separator`)
- Toggle или ToggleGroup (если нужен переключатель режима)
- Switch (`@/components/ui/switch`) — при необходимости

ТРЕБОВАНИЯ:

1) Перепроектируй страницу конструктора документов так, чтобы:
   - ToolBar, панели и холст были собраны ИЗ ЭТИХ КОМПОНЕНТОВ.
   - Не использовать самописные «кнопки», если можно задействовать shadcn Button.
   - Лейаут и панели оформляй с помощью Card, ScrollArea, Tabs, Dialog и т.д.

2) В своём ответе:
   - давай полный готовый код компонентов (без `...`), с корректными импортами shadcn/ui;
   - НЕ придумывай новые пути импортов — используй паттерн `@/components/ui/...`.

3) В отдельном разделе «Интеграция shadcn/ui»:
   - перечисли, какие компоненты нужно добавить, если их ещё нет (конкретные команды `npx shadcn-ui add button card ...`);
   - покажи пример импорта (1-2 строки на каждый тип компонента).

==================================================
3. ВЫРАВНИВАНИЕ БЛОКОВ «КАК В FIGMA»
==================================================

Нужно реализовать систему выравнивания блоков на холсте, похожую на Figma:

Функциональность:

1. Множественное выделение блоков:
   - возможность выделить несколько блоков (например, через Shift+клик или drag-selection);
   - хранить массив `selectedBlockIds` в состоянии.

2. Кнопки выравнивания в toolbar:
   - Align left
   - Align center (по горизонтали)
   - Align right
   - Align top
   - Align middle (по вертикали)
   - Align bottom
   - Distribute horizontally
   - Distribute vertically

3. Поведение:
   - Выравнивание всегда основано на:
     - либо bounding-box выделения (min/max/center),
     - либо на первом/последнем выбранном элементе — определи стратегию и явно опиши её в комментариях.
   - Алгоритмы должны быть реализованы в чистых функциях (например, `alignBlocks(blocks, selectedIds, mode)`), возвращающих новый массив блоков.
   - Никаких магических чисел: опирайся на реальные поля `x`, `y`, `width`, `height`.

4. UI:
   - В toolbar добавь группу кнопок выравнивания с иконками (можно использовать emoji или простые иконки из кастомного набора, если внешний icon-пак не подключён).
   - Сами кнопки — shadcn Button / ToggleGroup.

5. В коде:
   - Покажи реальные реализации этих функций выравнивания.
   - Логику undo/redo обнови так, чтобы выравнивание тоже учитывалось в истории.

Сделай всё на фронтенде. Для выравнивания backend трогать не нужно.

==================================================
4. ПЕРЕРАБОТКА СТРАНИЦЫ КОНСТРУКТОРА (FRONTEND)
==================================================

У тебя уже есть страница Document Builder. Нужно её свежо переработать, НЕ ломая контракт с backend.

Сделай следующее:

1. Структура страницы:
   - Toolbar сверху: название шаблона, кнопки сохранения/загрузки, undo/redo, zoom, выравнивание, загрузка файла.
   - Левая панель (Sidebar):
     - вкладка с библиотекой блоков (Text, Table, Image, Signature, Rectangle и т.д.);
     - вкладка с загруженными файлами (список Source Files с API backend).
   - Центральный холст:
     - А4-лист (м.б. условная область) с сеткой или направляющими;
     - блоки — абсолютное позиционирование, масштабирование с учетом zoom.
   - Правая панель (Inspector):
     - детальные свойства выбранного блока (координаты, размеры, текст, стиль, рамки);
     - базовые настройки документа (формат, отступы и т.п.).

2. Лейаут/компоненты:
   - Вынеси логику в переиспользуемые компоненты (DocumentCanvas, Toolbar, Sidebar, Inspector).
   - Каждую панель оформляй через shadcn Card + ScrollArea.
   - Управляй layout через CSS/Tailwind классы, НО не изобретай свой design-system с нуля — используй аккуратные utility-классы и оранжевую палитру.

3. Состояние:
   - Доработай состояние так, чтобы:
     - поддерживать множественный выбор;
     - поддерживать историю изменений (undo/redo) — стек предыдущих состояний;
     - zoom (например, 50–200 %);
     - выделение/активный блок.

4. Код:
   - Дай ПОЛНЫЙ обновлённый код ключевых компонентов:
     - страницы (DocumentBuilderPage.tsx),
     - холста,
     - Toolbar,
     - панели блоков,
     - панели файлов,
     - инспектора.
   - Не используй лишние абстракции, которые нельзя сразу вставить в проект.
   - Не оставляй «псевдокомпоненты» и недописанный JSX.

==================================================
5. BACKEND: МИНИМАЛЬНЫЕ ДОРАБОТКИ (ТОЛЬКО ЕСЛИ НУЖНО)
==================================================

Правила:

1. НЕ создавай новых Django-приложений.
2. НЕ создавай новых backend-файлов ради красоты. Можно вносить изменения ТОЛЬКО в:
   - существующее приложение документов (например, documents/models.py, documents/serializers.py, documents/views.py, documents/urls.py),
   - уже существующие файлы, если без этого никак.

2. Любые изменения backend должны быть строго по делу, например:
   - добавить дополнительное поле в JSON-структуру шаблона (если нужно для хранения новой информации);
   - добавить новый endpoint для предпросмотра/экспорта (если это часть задачи);
   - оптимизировать существующий view/serializer.

3. Если считаешь, что backend трогать не нужно — явно напиши, что все улучшения реализованы на фронтенде и backend менять не требуется.

4. Если изменения всё же нужны:
   - покажи конкретные патчи: старый фрагмент -> новый фрагмент;
   - НЕ используй псевдокод;
   - укажи, какие миграции нужно выполнить.

==================================================
6. ФОРМАТ ОТВЕТА
==================================================

Разбей ответ на следующие большие разделы:

1) "Обновлённый дизайн и структура конструктора"
   - Кратко опиши концепцию layout и стиля.

2) "Код фронтенда"
   - Полный код обновлённой страницы конструктора и ключевых компонентов (DocumentBuilderPage, Toolbar, DocumentCanvas, Sidebar, Inspector и т.д.), с использованием shadcn/ui и оранжевой палитры.
   - Обновлённая логика состояния (множественный выбор, выравнивание, undo/redo, zoom).

3) "Код backend (если изменения необходимы)"
   - Конкретные патчи/фрагменты для существующих файлов.
   - Команды миграций, если меняется модель.

4) "Инструкция по интеграции в мой проект"
   - Подробный пошаговый гайд:

   4.1. Frontend:
        - какие новые файлы/компоненты создать или обновить (конкретные пути, например `src/pages/DocumentBuilderPage.tsx`, `src/components/document-builder/...`);
        - какие shadcn-компоненты нужно добавить, если их ещё нет (команды `npx shadcn-ui add ...`);
        - как обновить tailwind.config.js для оранжевой палитры;
        - как подключить/обновить роут `"/documents/builder"` в React Router;
        - куда вставить новый код.

   4.2. Backend:
        - что именно поменять в существующих файлах (с указанием путей);
        - какие миграции выполнить (конкретные команды `python manage.py makemigrations`, `python manage.py migrate`);
        - нужны ли дополнительные зависимости (если да — точные команды `pip install ...`).

   4.3. Проверка:
        - как локально проверить работу обновлённого конструктора;
        - какие URL открыть в браузере;
        - тестовый сценарий: загрузка файла, создание шаблона, выравнивание блоков, сохранение.

ОСОБО: НИКАКИХ ПЛЕЙСХОЛДЕРОВ И ЗАГЛУШЕК. Все примеры кода должны быть полностью рабочими, с реальными импортами, типами и логикой.
